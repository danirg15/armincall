<nav-bar></nav-bar>

<div class="container" >

<div class="page-header">
    <h2>Incidencias</h2>
</div>

<!--<button class="btn btn-primary btn-sm pull-right" [disabled]="!linkingAllowed">Asociar Llamadas</button> <br><br>-->

<ul class="nav nav-tabs">
    <li class="active" (click)="loadPendingTickets()">
        <a  data-toggle="tab" aria-expanded="true">Incidencias Pendientes</a>
    </li>
    <li class="" (click)="loadHistoryTickets()">
        <a  data-toggle="tab" aria-expanded="false">Historial</a>
    </li>
</ul>


<br>

<table class="table table-striped table-hover ">
    <thead>
        <tr>
            <th>Taller</th>
            <th>Categoría</th>
            <th>Descripción</th>
            <th>Fecha/Hora</th>
            <th>Acción</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let ticket of tickets">
            <td> 
                <a [routerLink]="['/workshops', ticket.workshop._id]"> 
                    {{ ticket.workshop.name }} 
                </a> 
                &nbsp;
                <span class="label label-info" 
                      style="font-size: 1.1rem"
                      *ngIf="ticket.calls.length > 0">
                    <i class="fa fa-volume-control-phone" aria-hidden="true"></i> 
                    {{ ticket.calls.length }}
                </span>
            </td>
            <td>{{ ticket.category }}</td>
            <td>{{ ticket.description }}</td>
            <td>{{ ticket.createdAt | diffForHumans }}</td>
            <td>
                <a class="btn btn-primary btn-sm" [routerLink]="['/tickets', ticket._id]" >
                    <i class="fa fa-search" aria-hidden="true"></i>
                </a>
                
                &nbsp;

                <span [hidden]="discardButtonHidden">
                    <a  class="btn btn-warning btn-sm" 
                        (click)="setAsCompleted(ticket)">
                        Descartar
                    </a>
                </span>

            </td>
        </tr>
    </tbody>
</table> 

</div>