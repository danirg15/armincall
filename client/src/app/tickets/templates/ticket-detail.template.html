<nav-bar></nav-bar>

<div class="container">

    <div class="panel panel-default">
        <div class="panel-heading"><h5>Incidencia</h5></div>
        <div class="panel-body">
            
            <form class="form-horizontal">
                
                <div class="form-group">
                    <label for="" class="col-sm-2 control-label"><strong>Taller</strong></label>
                    <div class="col-sm-10">
                        <span class="form-control">
                            <a [routerLink]="['/workshops', ticket.workshop._id]">
                                {{ ticket.workshop.name }}
                            </a>
                        </span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="" class="col-sm-2 control-label"><strong>Descripción</strong></label>
                    <div class="col-sm-10">
                        <span class="form-control">
                            {{ ticket.category}}
                        </span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="" class="col-sm-2 control-label"><strong>Incidencia</strong></label>
                    <div class="col-sm-10">
                        <span class="form-control">
                            {{ ticket.description }}
                        </span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="" class="col-sm-2 control-label"><strong>Creada</strong></label>
                    <div class="col-sm-10">
                        <span class="form-control">
                            {{ ticket.createdAt | humanizeDate }}
                        </span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="" class="col-sm-2 control-label"><strong>Resuelta</strong></label>
                    <div class="col-sm-10">
                        <span class="form-control">
                            {{ ticket.completed ? 'Si' : 'No' }} 
                            
                            <span *ngIf="ticket.completed" >
                                ({{ ticket.updatedAt | humanizeDate }})
                            </span>
                            
                        </span>
                    </div>
                </div>

            </form>


        </div>
    </div>

    <div class="panel panel-info" *ngIf="ticket.calls.length > 0">
        <div class="panel-heading">
            <h3 class="panel-title">Llamadas</h3>
        </div>
        <div class="panel-body">

            <table class="table table-striped table-hover ">
                <thead>
                    <tr>
                        <th>Emisor</th>
                        <th>Receptor</th>
                        <th>Fecha/Hora</th>
                        <th>Duración</th>
                        <th>Estado</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let call of ticket.calls">
                        <td>{{call.callerNumber}}</td>
                        <td>{{call.recieverNumber}}</td>
                        <td>{{call.createdAt | humanizeDate}} ({{call.date | diffForHumans}})</td>
                        <td>{{call.durationInSeconds | durationForHumans}}</td>
                        <td>
                        
                            <div *ngIf="call.status == 'Respondida'">
                                <a data-toggle="tooltip" data-placement="right" title="{{call.status}}">
                                    <i class="fa fa-phone-square fa-2x" 
                                    style="color:green"
                                    aria-hidden="true"></i>
                                </a>
                            </div>

                            <div *ngIf="call.status == 'No Respondida'">
                                <a data-toggle="tooltip" data-placement="right" title="{{call.status}}">
                                    <i class="fa fa-phone-square fa-2x" 
                                    style="color:red"
                                    aria-hidden="true"></i>
                                </a>
                            </div>

                            <div *ngIf="call.status == 'Ocupada'">
                                <a data-toggle="tooltip" data-placement="right" title="{{call.status}}">
                                    <i class="fa fa-phone-square fa-2x" 
                                    style="color:#ff9800"
                                    aria-hidden="true"></i>
                                </a>
                            </div>

                            <div *ngIf="call.status == 'Fallada'">
                                <a data-toggle="tooltip" data-placement="right" title="{{call.status}}">
                                    <i class="fa fa-phone-square fa-2x" 
                                    style="color:grey"
                                    aria-hidden="true"></i>
                                </a>
                            </div>

                        </td>
                    </tr>
                </tbody>
            </table> 
            
        </div>
    </div>


</div>
