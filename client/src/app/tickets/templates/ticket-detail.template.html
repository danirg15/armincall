<nav-bar></nav-bar>

<div class="container">

    <div class="panel panel-default">
        <div class="panel-heading"><h5>Incidencia</h5></div>
        <div class="panel-body">
            
            <form class="form-horizontal">
                
                <div class="form-group">
                    <label for="" class="col-sm-2 control-label"><strong>Taller</strong></label>
                    <div class="col-sm-10">
                        <span class="form-control">
                            <a [routerLink]="['/workshops', ticket.workshop._id]">
                                {{ ticket.workshop.name }}
                            </a>
                        </span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="" class="col-sm-2 control-label"><strong>Categoria</strong></label>
                    <div class="col-sm-10">
                        <span class="form-control">
                            {{ ticket.category }}
                        </span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="" class="col-sm-2 control-label"><strong>Incidencia</strong></label>
                    <div class="col-sm-10">
                        <span class="form-control">
                            {{ ticket.description }}
                        </span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="" class="col-sm-2 control-label"><strong>Creada</strong></label>
                    <div class="col-sm-10">
                        <span class="form-control">
                            {{ ticket.createdAt | humanizeDate }}
                        </span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="" class="col-sm-2 control-label"><strong>Resuelta</strong></label>
                    <div class="col-sm-10">
                        <span class="form-control">
                            {{ ticket.completed ? 'Si' : 'No' }} 
                            
                            <span *ngIf="ticket.completed" >
                                ({{ ticket.updatedAt | humanizeDate }})
                            </span>
                            
                        </span>
                    </div>
                </div>

            </form>


        </div>
    </div>

    <div class="panel panel-primary" *ngIf="ticket.calls.length > 0">
        <div class="panel-heading">
            <h3 class="panel-title">Llamadas</h3>
        </div>
        <div class="panel-body">

            <table class="table table-striped table-hover ">
                <thead>
                    <tr>
                        <th>Emisor</th>
                        <th>Receptor</th>
                        <th>Fecha/Hora</th>
                        <th>Duraci√≥n</th>
                        <th>Estado</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let call of ticket.calls">
                        <td>
                            <span *ngIf="call.callerNumber == '917376582'">ARMIN</span>
                            <span *ngIf="call.callerNumber != '917376582'">{{call.callerNumber | formattedPhone}}</span>
                        </td>
                        <td>
                            <span *ngIf="call.recieverNumber == '0102' || call.recieverNumber == '0101'">ARMIN</span>
                            <span *ngIf="call.recieverNumber != '0102' && call.recieverNumber != '0101'">{{call.recieverNumber | formattedPhone}}</span>
                        </td>
                        <td>{{call.createdAt | humanizeDate}} ({{call.date | diffForHumans}})</td>
                        <td>{{call.durationInSeconds | durationForHumans}}</td>
                        <td>
                            <div [ngSwitch]="call.status">
                                <span *ngSwitchCase="'Respondida'" style="color:green">Respondida</span>
                                <span *ngSwitchCase="'Sin responder'" style="color:red">Sin Responder</span>
                                <span *ngSwitchCase="'Ocupada'" style="color:#ff9800">Ocupada</span>
                                <span *ngSwitchCase="'Fallada'" style="color:grey">Fallada</span>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table> 
            
        </div>
    </div>


</div>
