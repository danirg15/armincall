<nav-bar></nav-bar>

<div class="container">

  <div class="row">
      <div class="col-md-12 offset-md-1">

        <form class="form-horizontal" [formGroup]="form" (ngSubmit)="onSubmit($event)">
          <fieldset>
            <legend>{{title}}</legend>

            <div class="row">

              <div class="col-md-6">
                <div class="form-group" [class.has-danger]="form.controls.name.touched && form.controls.name.errors">
                  <label for="inputName" class="col-lg-3 form-control-label">* Razón Social</label>
                  <div class="col-lg-9">
                    <input [(ngModel)]="workshop.name" type="text" class="form-control form-control-danger" formControlName="name" placeholder="Razón Social">

                    <div *ngIf="form.controls.name.touched && form.controls.name.errors" >
                        <small class="form-control-feedback" *ngIf="form.controls.name.errors.required">
                            El campo Razón Social es obligatorio.
                        </small>
                    </div>

                  </div>
                </div>

                <div class="form-group">
                  <label for="inputCIF" class="col-lg-3 form-control-label">CIF</label>
                  <div class="col-lg-9">
                    <input [(ngModel)]="workshop.cif" type="text" class="form-control" formControlName="cif" placeholder="CIF">
                  </div>
                </div>

                <div formGroupName="address">
                  <div class="form-group">
                    <label for="inputDireccion" class="col-lg-3 form-control-label">Dirección</label>
                    <div class="col-lg-9">
                      <input [(ngModel)]="workshop.address && workshop.address.description" type="text" class="form-control" formControlName="description" placeholder="Dirección">
                    </div>
                  </div>
                </div>

                <div class="form-group" [class.has-danger]="form.controls.distributor.touched && form.controls.distributor.errors">
                  <label for="selectDistribuidor" class="col-lg-3 form-control-label">* Distribuidor</label>
                  <div class="col-lg-9">
                    <select [(ngModel)]="workshop.distributor" class="form-control form-control-danger" formControlName="distributor">
                      <option>Elegir</option>
                      <option *ngFor="let distributor of distributors" value="{{distributor.code}}">
                          {{distributor.name}}
                      </option>
                    </select>
                    
                    <div *ngIf="form.controls.distributor.touched && form.controls.distributor.errors" >
                        <small class="form-control-feedback" *ngIf="form.controls.distributor.errors.required">
                            El campo Distribudor es obligatorio.
                        </small>
                    </div>
                  </div>
                </div>

                <div class="form-group" >
                  <label for="selectDistribuidor" class="col-lg-3 form-control-label">DMS Anterior</label>
                  <div class="col-lg-9">
                    <select [(ngModel)]="workshop.previous_dms" class="form-control form-control-danger" formControlName="previous_dms">
                      <option>Elegir</option>
                      <option *ngFor="let dsm of dmss" value="{{dsm.code}}">
                          {{dsm.name}}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="form-group" >
                  <label for="selectDistribuidor" class="col-lg-3 form-control-label">DMS Actual</label>
                  <div class="col-lg-9">
                    <select [(ngModel)]="workshop.current_dms" class="form-control form-control-danger" formControlName="current_dms">
                      <option>Elegir</option>
                      <option *ngFor="let dsm of dmss" value="{{dsm.code}}">
                          {{dsm.name}}
                      </option>
                    </select>
                  </div>
                </div>

              </div><!--col-->

              <div class="col-md-6">
                <div class="form-group">
                  <label for="inputContact" class="col-lg-3 form-control-label">Contacto</label>
                  <div class="col-lg-9">
                    <input [(ngModel)]="workshop.contact" type="text" class="form-control" formControlName="contact" placeholder="Persona de Contacto">
                  </div>
                </div>

                <div class="form-group">
                  <label for="inputEmail" class="col-lg-3 form-control-label">Email</label>
                  <div class="col-lg-9">
                    <input [(ngModel)]="workshop.email" type="email" class="form-control form-control-danger" formControlName="email" placeholder="Email">
                  </div>
                </div>
                
                <div class="form-group" [class.has-danger]="form.controls.phone.touched && form.controls.phone.errors">
                  <label for="inputTelefono" class="col-lg-3 form-control-label">* Teléfonos</label>
                  <div class="col-lg-9">
                    <input [(ngModel)]="workshop.phone" type="text" class="form-control form-control-danger" formControlName="phone" placeholder="Teléfono">
                    <small id="emailHelp" class="form-text text-muted">*Separar teléfonos por comas.</small>

                    <div *ngIf="form.controls.phone.touched && form.controls.phone.errors" >
                        <small class="form-control-feedback" *ngIf="form.controls.phone.errors.required">
                            El campo Telefono es obligatorio.
                        </small>
                        <br>
                        <small class="text-danger" *ngIf="form.controls.phone.errors.phone">
                            Los teléfonos deben estar separados por comas.
                        </small>
                    </div>

                  </div>
                </div>

                <div class="form-group">
                  <div class="col-lg-9 col-lg-offset-3">
                    <button type="reset" class="btn btn-default" routerLink="/workshops">Cancelar</button>
                    <button type="submit" [disabled]="!form.valid" class="btn btn-primary">Guardar</button>
                  </div>
                </div>

              </div><!--col-->

            </div><!--row-->
            
          </fieldset>
        </form>
      
      </div>

  </div>



  <map *ngIf="workshop.address?.location"
      [lat]="workshop.address.location.lat"
      [lng]="workshop.address.location.lng"
  ></map>

  <br/>
  <br/>



</div>